CREATE TABLE HOTEL(
    HOTEL_ID char(9)  PRIMARY KEY NOT NULL,
    HOTEL_NAME char(20) NOT NULL,
    HOTEL_Email char(45) NOT NULL,
    HOTEL_ADDRESS char(45) NOT NULL,
    EMPLOYEE_ID char(20) NOT NULL,
    HOTEL_Manager_id char(20) NOT NULL,
    HOUSEKEEPS_no INT(9) NOT NULL,
    CONVENTION_HALL_NO INT(20) NOT NULL 

);

CREATE TABLE CUSTOMER(
    Guest_ID char(9) NOT NULL,
    Fname   VARCHAR(20)   NOT NULL,
    Minit   CHAR(2),
    Lname   VARCHAR(20) NOT NULL,
    Gender char(1),
    DOB char(8),
    Ph_No   BIGINT,
    Email char(45),
    Astate VARCHAR(20) ,
    City    VARCHAR(20),
    Country VARCHAR(20),
    PRIMARY KEY(Guest_ID)
);

CREATE TABLE RESERVATION(
    RESERVATION_ID  INT(20)  NOT NULL,
    GUEST_NO    INT NOT NULL,
    CHECKIN_DATE    DATE    NOT NULL,
    CHECKOUT_DATE   DATE    NOT NULL,
    PERIOD_STAY  INT,
    HALL_NUMBER INT,
    ROOM_NUMBER INT,
    CATEGORY    VARCHAR(30),
    PRIMARY KEY(RESERVATION_ID),
    
    CONSTRAINT RESERVING
        FOREIGN KEY(GUEST_NO)   REFERENCES  CUSTOMER(Guest_ID)
            ON DELETE SET NULL ON UPDATE CASCADE,
    CONSTRAINT  RESERVING_ROOM
        FOREIGN KEY(ROOM_NUMBER)    REFERENCES  ROOM(ROOM_NO)
            ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT  RESERVING_HALL
        FOREIGN KEY(HALL_NUMBER)    REFERENCES  CONVENTION_HALL(HALL_NO)
            ON  DELETE CASCADE    ON UPDATE   CASCADE
);

CREATE TABLE ROOM(
    ROOM_NO INT NOT NULL,
    CATEGORY VARCHAR(10) NOT NULL,
    NO_OF_BEDS INT NOT NULL,
    AIR_COND BOOLEAN NOT NULL,
    CUSTOMER_ID INT NOT NULL,
    CONSTRAINT CUSTROOM
        FOREIGN KEY(CUSTOMER_ID) REFERENCES CUSTOMER(Guest_ID)
            ON DELETE SET NULL ON UPDATE CASCADE,
    UNIQUE(CUSTOMER_ID),
    PRIMARY KEY(ROOM_NO)
);

CREATE TABLE PAYMENT(
    GUEST_NUM INT,
    PAY_DATE DATE NOT NULL,
    INVOICE_NUMBER SERIAL NOT NULL,
    PAYMENT_METHODS VARCHAR(20) NOT NULL,
    CONSTRAINT PAY_GUEST
        FOREIGN KEY(GUEST_NUM) REFERENCES CUSTOMER(GUEST_ID)
            ON DELETE SET NULL ON UPDATE CASCADE,
    CONSTRAINT PAY_INVOICE
        FOREIGN KEY(INVOICE_NUMBER)  REFERENCES INVOICE(INVOICE_ID) 
            ON DELETE SET NULL ON UPDATE CASCADE);
    
CREATE TABLE EMPLOYEE(
    SALARY INT,
    FNAME VARCHAR(25) NOT NULL,
    MINIT CHAR(2),
    LNAME VARCHAR(25), 
    JOIN_DATE DATE ,
    DOB DATE ,
    EMP_NUMBER INT, 
    PRIMARY KEY(EMP_NUMBER)
     CONSTRAINT EMP_HOTEL
        FOREIGN KEY(EMP_NUMBER) REFERENCES CUSTOMER(EMPLOYEE_ID)
            ON DELETE SET NULL ON UPDATE CASCADE
    
);

CREATE TABLE BILL(
    BILL_ID SERIAL,
    AMOUNT INT NOT NULL,
    NAME VARCHAR(255),
    DATE DATE NOT NULL,
    PH_NO varchar(12),
    Customer_ID INT NOT NULL,
    PRIMARY KEY (BILL_ID),
    CONSTRAINT PERSONID
        FOREIGN KEY (Customer_ID) REFERENCES CUSTOMER(GUEST_ID)
            ON DELETE SET NULL  ON UPDATE CASCADE
);

CREATE TABLE INVOICE(
    INVOICE_ID SERIAL NOT NULL,
    INVOICE_DESCRIPTION VARCHAR(300),
    PRIMARY KEY(INVOICE_ID)
);

CREATE TABLE CONVENTION_HALL(
    HALL_NO INT,
    CATEGORY VARCHAR(10) NOT NULL,
    CAPACITY INT NOT NULL,
    AC BOOLEAN NOT NULL,
    CUST_ID INT NOT NULL,
    CONSTRAINT CUSTHALL 
        FOREIGN KEY(CUST_ID) REFERENCES CUSTOMER(GUEST_ID) 
            ON DELETE SET NULL ON UPDATE CASCADE,
    CONSTRAINT HOTHALL
        FOREIGN KEY(HALL_NO) REFERENCES HOTEL(CONVENTION_HALL_NO)
            ON DELETE SET NULL ON UPDATE CASCADE
    PRIMARY KEY (HALL_NO)
);


CREATE TABLE HOTEL_MANAGER(
    MANAGER_ID char(20) PRIMARY KEY NOT NULL,
    START_DATE DATE,
    EMP_ID INT,
    CONSTRAINT  HMEMPLOYEE 
        FOREIGN KEY(EMP_ID) REFERENCES  EMPLOYEE(EMP_NUMBER)
            ON UPDATE   SET NULL ON DELETE SET NULL,
    CONSTRAINT HMHOTEL
        FOREIGN KEY(MANAGER_ID) REFERENCES HOTEL(HOTEL_Manager_id)
            ON DELETE SET NULL ON UPDATE CASCADE
);

CREATE TABLE HOUSEKEEPS(
    HOUSEKEEPS_NO INT PRIMARY KEY NOT NULL,
    EMP_NUM INT,
    ROOM_NUM INT,
    HALL_NUM INT,
    CONSTRAINT HOUSE_EMP
        FOREIGN KEY(EMP_NUM) REFERENCES EMPLOYEE(EMP_NUMBER) 
            ON DELETE SET NULL ON UPDATE CASCADE,
    CONSTRAINT HOUSE_ROOM
        FOREIGN KEY(ROOM_NUM) REFERENCES ROOM(ROOM_NO)
            ON DELETE SET NULL ON UPDATE CASCADE,
    CONSTRAINT HOUSE_HALL
        FOREIGN KEY(HALL_NUM) REFERENCES CONVENTION_HALL(HALL_NO)
            ON DELETE SET NULL ON UPDATE CASCADE
    CONSTRAINT HOUSE_HOTEL
        FOREIGN KEY(HOUSEKEEPS_NO) REFERENCES HOTEL(HOUSEKEEPS_no)
            ON DELETE SET NULL ON UPDATE CASCADE
);

INSERT INTO HOTEL
VALUES      ('537273828','Capricorn Hotel','CapricornHotel@gmail.com','(205) 631-8460 3020 Watts Dr Gardendale',123456789,123456789,479742,1),
            ('837452940','All Access Hotel','AllAccessHotel@gmail.com','(270) 369-9275 540 Grays',791396445,271307962,357953,2),
            ('738294621','Hotel Extreme','HotelExtreme@gamil.com','13737 Wyeth Cajon, California(CA)',999887777,791396445,653212,3),
            ('649274820','Omega Hotel','OmegaHotel@gmail.com','3 Elm Pl Bellmawr, New Jersey(NJ',987654321,318214984,567890,4),
            ('648291747','Glory Hotel','GloryHotel@gmail.com','3900 Abbeyville Rd Medina, Ohio(OH)',666884444,257976424,345678,5);
            
INSERT INTO CUSTOMER
VALUES      (693722755,'Hipolito','F','Haney','M','06/22/1998',9555577113,'sonjaalex@onlinecmail.com','Mississippi','Detroit','USA'),
            (271307962,'Selene','D','Oconnell','F','12/10/1984',9455506846,'mousekey@24mail.top','Magnolia State','Tucson','USA'),
            (540592037,'Yaeko','H','Hopkins','M','04/25/1988',7555530955,'teklachumburidze@masjoco.com','Alaska','Omaha','USA'),
            (791396445,'Marlene','E','Stephens','F','11/03/1999',8555725362,'klinlasa@bestiengine.com','The Last Frontier','Fresno','USA'),
            (318214984,'Pamella','G','Perkins','F','06/02/1986',8555349363,'rhasaan@policity.ml','Oklahoma','Oklahoma City','USA');

INSERT INTO RESERVATION
VALUES      (150,693722755,'2019-03-23','2019-03-24',5,1,101,'Superior room'),
            (144,271307962,'2019-03-23','2019-03-25',8,2,102,'Deluxe room'),
            (163,540592037,'2019-03-23','2019-03-26',2,3,103,'Guest house'),
            (167,791396445,'2019-03-23','2019-03-24',4,1,104,'Single room'),
            (159,318214984,'2019-03-23','2019-03-25',6,2,105,'Superior room');

INSERT INTO ROOM
VALUES      (101,'Superior room',1,TRUE,318214984),
            (102,'Deluxe room',2,FALSE,540592037),
            (103,'Guest house',3,TRUE,693722755),
            (104,'Single room',1,FALSE,791396445),
            (105,'Superior room',2,TRUE,271307962);
            
INSERT INTO PAYMENT
VALUES      (693722755,'2019-03-24',1658416,'cash'),
            (271307962,'2019-03-25',3546211,'cash'),
            (540592037,'2019-03-23',8439617,'card'),
            (791396445,'2019-03-23',2089814,'cash'),
            (318214984,'2019-03-25',1698519,'card');

INSERT INTO EMPLOYEE
VALUES      (4244,'Patrick','G','Hall','11-26-1991','09-23-1986',123456789),
            (8624,'Aiden','S','Chapman','07-30-1987','02-29-1996',791396445),
            (4313,'Max','E','Payne','05-13-2002','01-11-2001',999887777),
            (4957,'Garry','H','Hawkins','11-10-2002','01-11-2002',987654321),
            (6866,'Reid','D','Murphy','07-13-1986','04-06-1991',666884444);
            
INSERT INTO BILL
VALUES      (453453453,423,'bill23','2019-03-24','503-473-3060',693722755),
            (987987987,321,'bill42','2019-03-25','405-785-1491',271307962),
            (888665555,664,'bill45','2019-03-26','858-845-5107',540592037),
            (333445555,356,'bill32','2019-03-24','703-335-9288',791396445),
            (987654321,724,'bill41','2019-03-25','916-650-4739',318214984);
            
INSERT INTO INVOICE
VALUES      (1658416,'Superior room, bill23'),
            (3546211,'Guest house, bill45'),
            (8439617,'Guest house, bill42'),
            (2089814,'Single room, bill32'),
            (1698519,'Superior room, bill41');
            
INSERT INTO CONVENTION_HALL
VALUES      (1,'Big',1000,TRUE,693722755),
            (2,'Small',500,FALSE,271307962),
            (3,'Small',2000,FALSE,540592037),
            (4,'Big',1000,FALSE,791396445),
            (5,'Big',1500,TRUE,318214984);
            
INSERT INTO HOTEL_MANAGER
VALUES      (123456789,'2019/03/24',123456789),
            (271307962,'11/26/1991',271303962),
            (791396445,'07/13/1986',666884423),
            (318214984,'05/13/2002',888668532),
            (257976424,'30/05/1999',357853234);
            
INSERT INTO HOUSEKEEPS
VALUES      (479742,123456789,101,1),
            (357953,666884423,102,2),
            (653212,357853234,106,6),
            (567890,791396445,104,5),
            (345678,666884444,101,1);
            
            
/ROOM DETAILS OF CUSTOMER GIVEN/            
/*SELECT FNAME,MINIT,LNAME,GUEST_ID,PH_NO,ASTATE,CITY,ROOM_NO,CATEGORY 
    FROM    CUSTOMER,ROOM
    WHERE GUEST_ID=CUSTOMER_ID AND CUSTOMER_ID=540592037;
*/

/* ROOM AND CUSTOMER DETAIS GIVEN A CERTAIN CATEGORY OF ROOM*/
/*SELECT FNAME, LNAME 
FROM CUSTOMER,ROOM 
WHERE GUEST_ID=CUSTOMER_ID AND CATEGORY='Single room';
*/

/* RESRVATION AND CUSTOMER DETAILS GIVEN A CUSTOMER ID*/
/*SELECT GUEST_ID,RESERVATION_ID,FNAME,LNAME,CHECKIN_DATE,CHECKOUT_DATE,ROOM_NUMBER
FROM    RESERVATION,ROOM,CUSTOMER
WHERE   ROOM_NO=ROOM_NUMBER AND ROOM_NUMBER=102 AND GUEST_ID=CUSTOMER_ID AND CUSTOMER_ID=540592037;
*/

/* ALL EMPLOYEES HOUSEKEEPING A CERTAIN ROOM*/
/*SELECT FNAME, LNAME 
FROM EMPLOYEE AS E,HOUSEKEEPS AS H 
WHERE E.EMP_NUMBER=H.EMP_NUMBER AND H.HALL_NUM=1;
*/

/* ALL EMPLOYEES HOUSEKEEPING A CERTAIN CONVENTION HALL*/
/*SELECT FNAME, LNAME 
FROM EMPLOYEE AS E,HOUSEKEEPS AS H 
WHERE E.EMP_NUMBER=H.EMP_NUMBER AND H.ROOM_NUM=104;
*/

/*SELECT DISTINCT HALL_NUM
FROM HOUSEKEEPS, ROOM
WHERE ROOM_NUM = ROOM_NO ;
*/

/* ALL EMPLOYEES BORN IN FEBREUARY
SELECT FNAME, LNAME
FROM EMPLOYEE
WHERE DOB LIKE '2_';
*/

/*SELECT FNAME
FROM EMPLOYEE
WHERE (SALARY between 3000 AND 5000 ) ;
*/

/*SELECT E.EMP_NUMBER
FROM EMPLOYEE AS E, HOUSEKEEPS AS H, CONVENTION_HALL AS C 
WHERE E.EMP_NUMBER = H.EMP_NUM AND H.HALL_NUM = C.HALL_NO
union
SELECT E.EMP_NUMBER
FROM EMPLOYEE AS E, HOUSEKEEPS AS H, ROOM AS R
WHERE E.EMP_NUMBER = H.EMP_NUM AND H.ROOM_NUM = R.ROOM_NO;
*/

/*SELECT  C.Fname, C.Lname, 1.5 * B.AMOUNT AS Increased_bill
FROM  CUSTOMER AS C, ROOM AS R , BILL AS B 
WHERE  B.Customer_ID=C.Guest_ID AND C.Guest_ID=R.CUSTOMER_ID AND C.Guest_ID=271307962;
*/

/*SELECT C.Fname, C.Lname  
FROM CUSTOMER AS C, CONVENTION_HALL AS V, RESERVATION AS R
WHERE C.Guest_ID =  R.GUEST_NO AND C.Guest_ID = V.CUST_ID
ORDER BY C.Lname , C.Fname;
*/

/*CREATE TABLE VIP_CUSTOMER like CUSTOMER
    (SELECT C.*
     FROM CUSTOMER AS C
    WHERE C.Gender = 'F')
WITH DATA;
*/

/*DELETE FROM CUSTOMER
WHERE Lname='Stephens';
*/

/*UPDATE PAYMENT
SET PAYMENT_METHODS = 'Credit Card'
WHERE PAYMENT_METHODS = 'card';
*/
